# Correlations and regression

All semester so far, your professor has been fixated on our basketball team's shooting percentage, which is not good lately. The question is ... does it matter?

This is what we're going to start to answer today. And we'll do it with scatterplots and correlations.

First, we need libraries and [data](https://www.dropbox.com/s/0lpvstsjziz5k6p/logs.csv?dl=0).

```{r}
library(tidyverse)
```

```{r}
logs <- read_csv("~/Dropbox/SPMC350-Data-Literacy-and-Analytics-in-Sports/logs.csv")
```

To do this, we need all teams and their season stats. How much, over the course of a season, does a thing matter? That's the question you're going to answer. 

In our case, we want to know how much does shooting percentage influence wins? How much different can we explain in wins with shooting percentage? We're going to total up the number of wins each team has and their season shooting percentage in one swoop.

```{r}
logs %>% 
  group_by(Team) %>%
  summarize(
    wins = sum(W_L == "W"),
    totalFGAttempts = sum(TeamFGA),
    totalFG = sum(TeamFG)
  ) %>%
  mutate(fgpct = totalFG/totalFGAttempts) -> fgmodel
```

Now let's look at the scatterplot. With a scatterplot, we put what predicts the thing on the X axis, and the thing being predicted on the Y axis. In this case, X is our shooting percentage, y is our wins.

```{r}
ggplot(fgmodel, aes(x=fgpct, y=wins)) + geom_point()
```

Let's talk about this. It seems that the data slopes up to the right. That would indicate a positive correlation between shooting percentage and wins. And that makes sense, no? You'd expect teams that shoot the ball well to win. But can we get a better sense of this? Yes, by adding another geom -- `geom_smooth`.

```{r}
ggplot(fgmodel, aes(x=fgpct, y=wins)) + geom_point() + geom_smooth(method=lm, se=TRUE)
```

But ... how strong a relationship is this? How much can shooting percentage explain wins? Can we put some numbers to this?

Of course we can. We can apply a linear model to this. The way to read this is we're going to create an object called fit, and then we're going to put into that object a linear model -- `lm` -- and the way to read this is "wins are predicted by field goal percentage". Then we just want the summary of that model.

```{r}
fit <- lm(wins ~ fgpct, data = fgmodel)
summary(fit)
```

That's ... a lot. But it's really not. There's just a few things you really need.

The first thing: R-squared. In this case, the Adjusted R-squared value is .3812, which we can interpret as shooting percentage predicts about 40 percent of the variance in wins. Which sounds not great, but in social science, that's huge. That's great. A psychology major would murder for that R-squared.

Second: The P-value. We want anything less than .05. If it's above .05, the change between them is not statistically significant -- it's probably explained by random chance. In our case, we have 2.2e-16, which is to say 2.2 with 16 zeros in front of it, or .000000000000000022. Is that less than .05? Yes. Yes it is. So this is not random. Again, we would expect this, so it's a good logic test.

Third: The coefficient. In this case, the coefficient for fgpct is 108.82. Since I didn't convert percentages to decimals, what this says is that for every perentage point improvement in shooting percentage, we can expect the team to win 1.09 games more. 

And we can use this to predict a team's wins: remember your algebra. y = mx + b. In this case, y is the wins, m is the coefficient, x is the shooting percentage and b is the intercept. 

So can plug these together: Expected wins = 108.820 * shooting percentage - 35.762

Let's use Nebraska as an example. They're shooting about .44 on the season. 

y = 108.82 * .44 - 35.762 or 12.12 wins. How many wins do we have? 15. 

Nebraska is actually OVERPERFORMING it's season shooting percentage. 

### Assignment

The fun of this is that you can test all kinds of theories. Given what we have in our dataset, what do you think predicts Nebraska's win total? Rebounds? Rebound differential? Fouls? Three point shooting? Total up every team's season performance, produce a scatterplot and a linear model and evaluate. Does it? What's your R-squared? What's your P-value? Create a model -- y = mx + b -- and see how Nebraska is performing relative to expectations. 

##### Rubric

1. Did you import the data correctly?
2. Did you summarize it correctly?
3. Did you produce a scatterplot?
4. Did you produce a linear model?
5. Did you apply the model?
6. Did you interpret your results?
7. Did you comment your code in markdown?
